<% @taxonomies = Spree::Taxonomy.includes(root: :children) %>
<nav id="custom_taxonomies" class="navbar navbar-expand-lg mt-2">
  <%# show only the 1st positioned taxonomy %>
  <% if @taxonomies.size > 0  && taxonomy = @taxonomies.find_by(position: 1)%>
    <% taxonomy.root.children.each do |level_1| %>
      <% cache [I18n.locale, level_1] do %>
        <ul class="navbar-nav mr-auto">
          <li class="nav-item dropdown multi-level-dropdown">
            <% if level_1.children.size > 0 %>
              <%= link_to level_1.name, seo_url(level_1), class: "nav-link dropdown-toggle w-100"%>
              <ul class="dropdown-menu mt-0 border-0">
                <% level_1.children.each do |level_2|%>
                  <%= render 'spree/shared/custom_nested_submenu', current_level: level_2 %>
              <% end %>
              </ul>
            <% else %>
              <%= link_to level_1.name, seo_url(level_1), class: "nav-link w-100"%>
            <% end %>
          </li>
        </ul>
      <% end %>
    <% end %>
  <% end %>
</nav>
